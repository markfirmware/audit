<div x-data=data() x-init="init([], x => templates = x)">
  <a href=https://github.com/markfirmware/audit>
    markfirmware/audit
  </a>
  <div>
    npm search keywords:csa-template
    <ul>
        <template x-for="template in templates" :key=template.package.name>
        <li>
            <a :href="template.package.links.npm">
            npm
            </a>
            <a :href="template.package.links.repository">
            git
            </a>
              <span x-text="template.package.name">
            </span>
        </li>
        </template>
    </ul>
  </div>
</div>

<script>
    function data() {
        return { templates: [] };
    }

    function init(already, update) {
        update(already);
        fetch("https://registry.npmjs.org/-/v1/search?text=keywords:csa-template&size=10&from=" + already.length)
            .then((r) => r.json())
            .then((j) => {
                var batch = j.objects;
                if (batch.length != 0) {
                    var bigger = already.concat(batch);
                    bigger.sort((x, y) => {
                        let a = x.package.name,
                            b = y.package.name;
                        return a == b ? 0 : a < b ? -1 : 1;
                    });
                    init(bigger, update);
                }
            });
    }
</script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/alpinejs/2.7.3/alpine.js></script>